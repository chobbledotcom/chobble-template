{%- if config.has_products_filter -%}
{%- assign filterUI = collections.filterAttributes | buildFilterUIData: currentFilters -%}

{%- if filterUI.hasFilters -%}
<nav class="products-filter" aria-label="Product filters">
  {%- if filterUI.hasActiveFilters -%}
  <div class="filter-active">
    <span class="filter-active-label">Active filters:</span>
    {%- for filter in filterUI.activeFilters -%}
    <span class="filter-tag">
      <span class="filter-key">{{ filter.key }}:</span>
      <span class="filter-value">{{ filter.value }}</span>
      <a href="{{ filter.removeUrl }}" class="filter-remove" aria-label="Remove {{ filter.key }} filter">&times;</a>
    </span>
    {%- endfor -%}
    <a href="{{ filterUI.clearAllUrl }}" class="filter-clear">Clear all</a>
  </div>
  {%- endif -%}

  <div class="filter-groups">
    {%- for group in filterUI.groups -%}
    <div class="filter-group">
      <span class="filter-group-label">{{ group.label }}:</span>
      <ul class="filter-options">
        {%- for option in group.options -%}
        <li>
          {%- if option.active -%}
          <span class="filter-option active">{{ option.value }}</span>
          {%- else -%}
          <a href="{{ option.url }}" class="filter-option">{{ option.value }}</a>
          {%- endif -%}
        </li>
        {%- endfor -%}
      </ul>
    </div>
    {%- endfor -%}
  </div>
</nav>
{%- endif -%}
{%- endif -%}
