<div class="current-image">
  {% assign first_image = gallery[0] %}
  {%- assign image_filename = first_image | split: "/" | last -%}
  {%- assign alt_tag_entry = alt-tags | where: "path", image_filename | first -%}
  {%- assign alt_text = alt_tag_entry.alt | default: "" -%}
  {% image first_image, alt_text, config.products.gallery_image_widths, "", "100vw" %}
</div>

<div aria-hidden="true" class="gallery-full-size-images">
  {%- for image in gallery -%}
    {%- assign image_filename = image | split: "/" | last -%}
    {%- assign alt_tag_entry = alt-tags | where: "path", image_filename | first -%}
    {%- assign alt_text = alt_tag_entry.alt | default: "" -%}
    <div class="full-image-{{ forloop.index }}">
      {% image image, alt_text, config.products.gallery_image_widths, "fade-in", "100vw" %}
    </div>
  {% endfor %}
</div>

{%- if gallery.size > 1 -%}
<ul id="gallery" class="image-gallery">
  {%- for image in gallery -%}
    {%- assign image_filename = image | split: "/" | last -%}
    {%- assign alt_tag_entry = alt-tags | where: "path", image_filename | first -%}
    {%- assign alt_text = alt_tag_entry.alt | default: "" -%}
    <li>
      <a
        href="
          {%- if image[0] == "/" -%}
            {{- image -}}
          {%- else -%}
            /images/{{ image -}}
          {%- endif -%}
        "
        data-index="{{ forloop.index }}"
        class="image-link gallery-switcher"
      >
        <!-- once sizes="auto" is supported by Firefox, switch to that -->
        <figure>
          {% image image, alt_text, config.products.gallery_thumb_widths, "", "(max-width: 798px) 33vw, 25vw" %}
        </figure>
      </a>
    </li>
  {%- endfor -%}
</ul>
{%- endif -%}
