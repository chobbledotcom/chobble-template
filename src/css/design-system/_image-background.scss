@use "../variables" as *;
@use "../mixins" as *;

// =============================================================================
// IMAGE BACKGROUND
// =============================================================================
// Full-width image background with overlaid text content.
// Uses the {% image %} shortcode for responsive srcsets, cropped to 16/9.

.design-system {
  // Remove section padding when containing an image-background
  section:has(> .image-background),
  section:has(> .container > .image-background) {
    padding: 0;
  }

  .image-background {
    position: relative;
    width: 100%;
    overflow: hidden;
    aspect-ratio: 16/9;
    background: $color-dark-bg;

    // The image covers the entire container
    > div {
      position: absolute;
      inset: 0;

      img,
      .image-wrapper {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .image-wrapper img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
    }

    @include media-background-content;

    // Parallax: scroll-driven animation moves the image opposite to scroll
    &.parallax > div {
      // Extend the image beyond the container so it has room to translate
      inset: -15%;

      @supports (animation-timeline: scroll()) {
        animation: parallax-scroll linear;
        animation-timeline: scroll(nearest block);
        animation-range: entry 0% exit 100%;
      }
    }
  }
}

@keyframes parallax-scroll {
  from {
    transform: translateY(-10%);
  }

  to {
    transform: translateY(10%);
  }
}
