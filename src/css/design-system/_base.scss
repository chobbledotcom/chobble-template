@use "../variables" as *;
@use "../mixins" as *;
@use "../theme-adapter" as adapter;

// =============================================================================
// DESIGN SYSTEM ROOT
// =============================================================================
// All styles are scoped to .design-system to avoid affecting other page content

.design-system {
  // ===========================================================================
  // CSS CUSTOM PROPERTIES (scoped)
  // ===========================================================================
  // Uses theme-adapter to bridge legacy theme variables with design system.
  // Priority: design-system theme (--ds-*) → legacy theme (--color-*) → defaults

  @include adapter.theme-adapter-properties;

  // ===========================================================================
  // BASE RESET (scoped)
  // ===========================================================================

  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  scroll-behavior: smooth;

  @include reduced-motion {
    scroll-behavior: auto;
  }

  // ===========================================================================
  // ROOT STYLES
  // ===========================================================================

  margin: 0;
  padding: 0;
  font-family: var(--font-sans);
  font-size: $font-size-base;
  line-height: $line-height-normal;
  color: var(--text);
  background: var(--bg);
  -webkit-font-smoothing: antialiased;

  // ===========================================================================
  // TYPOGRAPHY
  // ===========================================================================

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    margin: 0 0 $space-md;
    font-family: var(--font-heading, var(--font-sans));
    font-weight: 700;
    line-height: $line-height-tight;
    text-wrap: balance;
  }

  h1 {
    @include heading-xl;
  }
  h2 {
    @include heading-lg;
    margin-bottom: $space-lg;
  }
  h3 {
    @include heading-md;
  }
  h4 {
    @include heading-sm;
  }

  p {
    margin: 0 0 $space-md;
    line-height: $line-height-relaxed;
    &:last-child {
      margin-bottom: 0;
    }
  }

  // Links - exclude buttons
  a:not(.btn) {
    color: var(--primary);
    text-decoration: none;
    transition: color $transition-fast;
    &:hover {
      text-decoration: underline;
    }
  }

  code {
    font-family: var(--font-mono);
    font-size: 0.9em;
    padding: 0.2em 0.4em;
    background: var(--bg-alt);
    border-radius: $radius-sm;
  }

  pre {
    margin: $space-lg 0;
    padding: $space-md;
    background: #{$color-dark-bg};
    color: #{$color-dark-text};
    border-radius: $radius-md;
    overflow-x: auto;
    code {
      background: none;
      padding: 0;
      color: inherit;
    }
  }

  img {
    max-width: 100%;
    height: auto;
    display: block;
  }

  ul,
  ol {
    margin: 0 0 $space-md;
    padding-left: $space-lg;
  }

  li {
    margin-bottom: $space-xs;
  }

  // ===========================================================================
  // SCROLL ANIMATIONS
  // ===========================================================================

  [data-reveal] {
    @include scroll-reveal;
  }

  [data-reveal="left"] {
    @include scroll-reveal-left;
  }

  [data-reveal="right"] {
    @include scroll-reveal-right;
  }

  [data-reveal="scale"] {
    @include scroll-reveal-scale;
  }

  @include reduced-motion {
    [data-reveal] {
      opacity: 1;
      transform: none;
      transition: none;
    }
  }

  // ===========================================================================
  // CONTAINER
  // ===========================================================================

  .container {
    @include container($width-wide);

    &--narrow {
      @include container($width-narrow);
    }
    &--default {
      @include container($width-default);
    }
  }

  // ===========================================================================
  // SECTION
  // ===========================================================================

  section {
    @include section;

    &.compact {
      @include section($space-2xl);
    }
    &.alt {
      background: var(--bg-alt);
    }
    &.dark {
      background: #{$color-dark-bg};
      color: #{$color-dark-text};
      --text: #{$color-dark-text};
      --text-muted: #{$color-dark-text-muted};
      --card-bg: #{$color-dark-card-bg};
    }
    &.gradient {
      background: linear-gradient(135deg, var(--primary-light) 0%, #faf5ff 100%);
    }
  }

  // ===========================================================================
  // BLOCK SPACING
  // ===========================================================================
  // Consistent vertical rhythm between block-level components (features, stats,
  // code-block, etc.) when used as direct children of .design-system

  > header,
  > .features,
  > ul.features,
  > .stats,
  > dl.stats,
  > .code-block,
  > .split,
  > .grid {
    margin-bottom: $space-2xl;

    &:last-child {
      margin-bottom: 0;
    }
  }

  // Extra spacing before section headers that follow content blocks
  > .features + header,
  > ul.features + header,
  > .stats + header,
  > dl.stats + header,
  > .code-block + header {
    margin-top: $space-xl;
  }
}
