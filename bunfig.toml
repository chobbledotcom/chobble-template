[test]
preload = ["./test/ensure-deps.js", "./test/setup.js"]

# Test file patterns
root = "./test"

# Parallel execution (default behavior in Bun)
# Bun automatically runs tests in parallel

# Timeout for individual tests (30 seconds)
timeout = 30000

# Always enable coverage reporting
coverage = true

# Coverage thresholds - tests fail if coverage drops below these levels
# Allows manual management of .coverage_exceptions.json while preventing regressions
coverageThreshold = { lines = 0.9928, functions = 0.9857 }

# Files excluded from coverage:
# - ensure-deps.js: defensive code that can't be meaningfully tested
# - canonical-url.js: module-load-time validation guards that can only fail if site.json is misconfigured
coveragePathIgnorePatterns = ["test/ensure-deps.js", "src/_lib/utils/canonical-url.js"]
